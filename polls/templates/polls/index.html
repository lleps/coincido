{% extends 'polls/base.html' %}

{% block title %}Inicio{% endblock %}

{% block content %}
    {% if user.is_authenticated %}
        <div class="row">
            <!-- Imagen top -->
            <div class="col-md-6">
                <img class="w-100" src="{{ cfg.imagen_principal.url }}" alt="Imágen principal">
            </div>

            <!-- Ver lista de beneficiarios -->
            <div class="col-md-6">

                <!-- Agregar beneficiario -->
                <div class="mt-1">
                    <a href="/beneficiario" class="btn btn-success btn-block mt-auto w-100 mb-1 mt-3">
                        <i class="fa fa-plus"></i> Añadir domicilio
                    </a>
                </div>

              {% if request.user.is_staff %}
                <div class="mb-2">
                    <a href="/resumen/0" class="btn btn-secondary btn-block mt-auto w-100 mb-1">
                        <i class="fa fa-file-alt"></i> Ver resumen
                    </a>
                </div>
                {% endif %}

                <ul class="list-group w-100" style="max-height: 500px;margin-bottom: 10px;overflow:scroll;">
                {% for match in result %}
                    <li class="list-group-item">
                        <h5>
                            {% if match.familiaJefeDNI != '' %}
                                {{ match.familiaJefeDNI }} {{ match.familiaJefeNombre }} {{ match.familiaJefeApellido }} /
                            {% endif %}
                            {{ match.barrio }}, {{ match.calle }} {{ match.numero }}.
                        </h5><br>

                        <!-- No se pudo hacer la entrevista -->
                        {% if not match.entrevistaEfectiva %}
                            <span class="text-warning">{{ match.entrevistaRazon }}</span>
                        {% else %}

                        <!-- Datos de si completó o no la encuesta -->
                        <span class="text-muted">

                            <!-- Completar datos de la familia -->
                            {% if not match.completoFamilia %}
                                <a href="familia/{{ match.id }}" class="btn btn-sm btn-outline-primary mr-3">
                                    Relevamiento Social / Solicitante
                                </a>
                            {% else %}
                                <span class="text-success"><i class="fa fa-check"></i> Relevamiento Social / Solicitante. </span>
                                <a href="familia/{{ match.id }}">Editar</a>
                            {% endif %}
                            <br>

                            <!-- Completar fotos del DNI -->
                            {% if not match.completoDNIFotos %}
                            <a href="dnifotos/{{ match.id }}" class="btn btn-sm btn-outline-primary mr-3">
                                DNI del niño/a y jefe/a.
                            </a>
                            {% else %}
                                <span class="text-success"><i class="fa fa-check"></i> DNI del niño/a y jefe/a. </span>
                                <a href="dnifotos/{{ match.id }}">Editar</a>
                            {% endif %}
                            <br>

                            <!-- Completar grupo familiar -->
                            {% if not match.completoGrupoFamiliar %}
                            <a href="grupofamiliar/{{ match.id }}" class="btn btn-sm btn-outline-primary mr-3">
                                Relevamiento Social / Grupo familiar
                            </a>
                            {% else %}
                                <span class="text-success"><i class="fa fa-check"></i> Relevamiento Social / Grupo familiar. </span>
                                <a href="grupofamiliar/{{ match.id }}">Editar</a>
                            {% endif %}
                            <br>

                            <!-- Completar datos de la vivienda -->
                            {% if not match.completoEncuesta %}
                                <a href="/{{ match.id }}/{{ match.first_unanswered_question }}" class="btn btn-sm btn-outline-primary mr-3">
                                    Relevamiento físico/ambiental
                                </a>
                            {% else %}
                                <span class="text-success text-sm"><i class="fa fa-check"></i> Relevamiento Físico/Ambiental. </span>
                                <a href="/{{ match.id }}/0">Editar</a>
                            {% endif %}
                            <br>

                            <!-- Completar observacion de la vivienda -->
                            {% if match.completoFamilia and match.completoGrupoFamiliar and match.completoEncuesta %}
                                {% if not match.completoObservaciones %}
                                    <a href="detalle/{{ match.id }}" class="btn btn-sm btn-outline-primary mr-3">
                                        Observaciones finales
                                    </a>
                                {% else %}
                                    <span class="text-success text-sm"><i class="fa fa-check"></i> Observaciones finales.
                                        <a href="detalle/{{ match.id }}">Editar</a>
                                        <br>
                                    <a class="btn btn-success" href="detalle/{{ match.id }}"><i class="fa fa-print"></i> Imprimir</a></span>
                                {% endif %}
                                <br>
                            {% endif %}


                        </span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>

        </div>


        </div>

    {% else %}
      <a href="{% url 'login' %}">Ingresar</a>
    {% endif %}

{% endblock %}